<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script>
      AFRAME.registerShader('premium-kaleidoscope', {
        schema: { time: { type: 'time', is: 'uniform' } },
        vertexShader: `
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,
        fragmentShader: `
          uniform float time;
          varying vec2 vUv;
          void main() {
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5) * 12.0;
            float radius = length(vUv - vec2(0.5));
            float pattern = sin(angle + time * 0.003) * cos(radius * 20.0 + time * 0.003);
            vec3 color1 = vec3(0.8, 0.2, 0.5) * sin(time * 0.002 + pattern);
            vec3 color2 = vec3(0.2, 0.8, 0.5) * cos(time * 0.002 - pattern);
            vec3 finalColor = mix(color1, color2, 0.5 + 0.5 * sin(time * 0.002));
            gl_FragColor = vec4(finalColor, 1.0);
          }
        `
      });

      AFRAME.registerComponent('animated-kaleidoscope', {
        init: function () {
          this.el.setAttribute('geometry', 'primitive: sphere; radius: 10');
          this.el.setAttribute('material', 'shader: premium-kaleidoscope; side: double');
        }
      });
    </script>
  </head>
  <body>
    <a-scene background="color: black">
      <a-entity position="0 0 0">
        <a-entity animated-kaleidoscope></a-entity>
      </a-entity>
      <a-entity light="type: ambient; intensity: 1"></a-entity>
      <a-entity light="type: point; intensity: 2; color: #FF00FF" position="3 5 2"></a-entity>
      <a-entity light="type: point; intensity: 2; color: #00FFFF" position="-3 -5 -2"></a-entity>
      <a-entity camera wasd-controls look-controls position="0 0 0"></a-entity>
    </a-scene>
  </body>
</html>