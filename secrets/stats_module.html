<div class="stats-container">
    <h2 class="text-2xl font-bold mb-6">ðŸ“ˆ Uptime Monitoring</h2>
    
    <div class="card bg-base-100 shadow">
        <div class="card-body">
            
            <div class="flex justify-between items-center mb-4">
            
                <h3 class="card-title">Service Status</h3>
            
                <button class="btn btn-sm" onclick="loadUptimeStats()">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                    </svg>
                    Refresh
                </button>
            
            </div>
            
            <div id="uptime-monitors">
                <div class="flex justify-center">
                    <span class="loading loading-spinner loading-lg"></span>
                </div>
            </div>
        
        </div>
    </div>
</div>



<script>
    (() => {

        async function loadUptimeStats() {
      
            const container = document.getElementById('uptime-monitors');
      
            if (!container) return;

            try {
      
      
                container.innerHTML = '<div class="flex justify-center"><span class="loading loading-spinner loading-lg"></span></div>';
                
                const response = await fetch('/admin/api/uptime-stats', { credentials: 'include' });
                const data = await response.json();
                
                renderUptimeStats(data.monitors);
      
      
      
      
            } catch (err) {
      
                console.error('Uptime stats error:', err);
      
                if (container) {
      
                    container.innerHTML = `<div class="alert alert-error">${err.message}</div>`;
      
                }
            }
        }


      
      
        function renderUptimeStats(monitors) {

            const container = document.getElementById('uptime-monitors');

            if (!container) return;

            if (!monitors?.length) {

                container.innerHTML = '<div class="alert alert-info">No monitors</div>';
                return;

            }



            container.innerHTML = monitors.map(monitor => `
                <div class="card ${monitor.status === 2 ? 'bg-base-100' : 'bg-error/10'}">
                    <div class="card-body p-4">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold">${monitor.friendly_name}</h3>
                            <span class="badge ${monitor.status === 2 ? 'badge-success' : 'badge-error'}">
                                ${monitor.status === 2 ? 'UP' : 'DOWN'}
                            </span>
                        </div>
                        <div class="mt-2">
                            <div class="flex justify-between text-sm">
                                <span>Uptime:</span>
                                <span class="font-bold">${monitor.all_time_uptime_ratio}%</span>
                            </div>
                            <progress class="progress ${monitor.status === 2 ? 'progress-success' : 'progress-error'} w-full mt-1" 
                                    value="${monitor.all_time_uptime_ratio}" max="100"></progress>
                        </div>
                    </div>
                </div>
            `).join('');
        }


        if (document.getElementById('uptime-monitors')) {

            loadUptimeStats();

            document.querySelector('button[onclick="loadUptimeStats()"]')
                .addEventListener('click', loadUptimeStats);
        }
    })();
</script>